<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Progetto: Editor di Testo | Corso Rust Linux Desktop</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="header-content">
            <div class="rust-logo">ü¶Ä</div>
            <h1>Corso Completo: Sviluppo Applicazioni Desktop Linux in Rust</h1>
        </div>
        <button class="menu-toggle" aria-label="Menu">‚ò∞</button>
    </header>

    <div class="container">
        <aside class="sidebar">
            <h3>üìö Corso</h3>
            <ul><li><a href="index.html">üè† Home</a></li></ul>
            <h3>1. Ambiente</h3>
            <ul><li><a href="lesson-1-1.html">1.1 Installazione Rust</a></li>
            <li><a href="lesson-1-2.html">1.2 Config VS Code</a></li>
            <li><a href="lesson-1-3.html">1.3 Strumenti Extra</a></li></ul>
            <h3>2. Rust Base</h3>
            <ul><li><a href="lesson-2-1.html">2.1 Sintassi</a></li>
            <li><a href="lesson-2-2.html">2.2 Controllo</a></li>
            <li><a href="lesson-2-3.html">2.3 Progetto</a></li>
            <li><a href="lesson-2-4.html">2.4 Crate</a></li></ul>
            <h3>3. GUI</h3>
            <ul><li><a href="lesson-3-1.html">3.1 GTK-rs</a></li>
            <li><a href="lesson-3-2.html">3.2 Glade</a></li>
            <li><a href="lesson-3-3.html">3.3 Manuale</a></li>
            <li><a href="lesson-3-4.html">3.4 Widget</a></li>
            <li><a href="lesson-3-5.html">3.5 Menu</a></li></ul>
            <h3>4. Progetti</h3>
            <ul><li><a href="lesson-4-1.html">4.1 Editor</a></li>
            <li><a href="lesson-4-2.html">4.2 Note DB</a></li>
            <li><a href="lesson-4-3.html">4.3 HTTP</a></li></ul>
            <h3>5. GitHub</h3>
            <ul><li><a href="lesson-5-1.html">5.1 Repository</a></li>
            <li><a href="lesson-5-2.html">5.2 Documentazione</a></li>
            <li><a href="lesson-5-3.html">5.3 Testing</a></li></ul>
            <h3>üìñ Risorse</h3>
            <ul><li><a href="about.html">‚ÑπÔ∏è Info Corso</a></li>
            <li><a href="resources.html">üîó Risorse</a></li>
            <li><a href="faq.html">‚ùì FAQ</a></li></ul>
        </aside>

        <main class="content">
            <nav class="breadcrumb"><a href="index.html">Home</a> > Sezione 4: Progetti Pratici > Progetto: Editor di Testo</nav>
            <h2 class="lesson-title">Progetto: Editor di Testo</h2>

            <div class="box box-theory">
                <h3>üìò Introduzione Teorica</h3>
                <p><strong>Editor di testo completo</strong> che integra molteplici concetti GTK:</p>
<ul>
    <li><strong>TextView</strong>: Widget multilinea per editing</li>
    <li><strong>File I/O</strong>: Lettura e salvataggio file</li>
    <li><strong>MenuBar</strong>: Barra menu (File, Edit, Help)</li>
    <li><strong>Toolbar</strong>: Azioni rapide con bottoni</li>
    <li><strong>FileChooserDialog</strong>: Dialogo selezione file</li>
    <li><strong>State management</strong>: Tracciamento modifiche</li>
    <li><strong>StatusBar</strong>: Feedback all'utente</li>
</ul>
<p>Applicazione desktop full-featured pronta per uso reale, oltre 400 righe di codice Rust.</p>
            </div>

            <div class="box box-steps">
                <h3>üîß Procedura Passo-Passo</h3>
                <ol>
    <li><strong>Setup progetto GTK</strong>
        <pre><code>cargo new text_editor
cd text_editor
# Aggiungi Cargo.toml:
# [dependencies]
# gtk = { version = "0.18", features = ["v3_24"] }</code></pre>
    </li>

    <li><strong>Struttura finestra base</strong>
        <pre><code>let window = ApplicationWindow::builder()
    .title("Text Editor")
    .default_width(800)
    .default_height(600)
    .build();

let textview = TextView::new();
let scrolled = ScrolledWindow::new();
scrolled.add(&textview);</code></pre>
    </li>

    <li><strong>MenuBar con File menu</strong>
        <pre><code>let menubar = MenuBar::new();
let file_menu = Menu::new();
let file_item = MenuItem::with_label("File");
file_item.set_submenu(Some(&file_menu));

let new_item = MenuItem::with_label("Nuovo");
let open_item = MenuItem::with_label("Apri");
let save_item = MenuItem::with_label("Salva");
file_menu.append(&new_item);
file_menu.append(&open_item);
file_menu.append(&save_item);</code></pre>
    </li>

    <li><strong>Toolbar con bottoni azioni</strong>
        <pre><code>let toolbar = Box::new(Orientation::Horizontal, 5);
let new_btn = Button::with_label("üìÑ Nuovo");
let open_btn = Button::with_label("üìÇ Apri");
let save_btn = Button::with_label("üíæ Salva");
toolbar.pack_start(&new_btn, false, false, 0);
toolbar.pack_start(&open_btn, false, false, 0);
toolbar.pack_start(&save_btn, false, false, 0);</code></pre>
    </li>

    <li><strong>File I/O</strong>
        <pre><code>use std::fs;

fn load_file(path: &str) -> Result<String, std::io::Error> {
    fs::read_to_string(path)
}

fn save_file(path: &str, content: &str) -> Result<(), std::io::Error> {
    fs::write(path, content)
}</code></pre>
    </li>
</ol>
            </div>

            <div class="box box-code">
                <h3>üíª Codice Sorgente Commentato</h3>
                <pre><code>// ========================================
// PROGETTO: TEXT EDITOR COMPLETO
// ========================================

use gtk::prelude::*;
use gtk::{Application, ApplicationWindow, Box, Button, Entry,
          Label, MenuBar, Menu, MenuItem, TextView, ScrolledWindow,
          FileChooserDialog, FileChooserAction, ResponseType, Orientation};
use std::fs;
use std::cell::RefCell;
use std::rc::Rc;

fn main() {
    let app = Application::builder()
        .application_id("com.example.TextEditor")
        .build();

    app.connect_activate(build_ui);
    app.run();
}

fn build_ui(app: &Application) {
    let window = ApplicationWindow::builder()
        .application(app)
        .title("Text Editor")
        .default_width(800)
        .default_height(600)
        .build();

    let vbox = Box::new(Orientation::Vertical, 0);

    // ---- MENUBAR ----
    let menubar = MenuBar::new();

    let file_menu = Menu::new();
    let file_item = MenuItem::with_label("File");
    file_item.set_submenu(Some(&file_menu));

    let new_item = MenuItem::with_label("Nuovo");
    let open_item = MenuItem::with_label("Apri");
    let save_item = MenuItem::with_label("Salva");
    let quit_item = MenuItem::with_label("Esci");

    file_menu.append(&new_item);
    file_menu.append(&open_item);
    file_menu.append(&save_item);
    file_menu.append(&quit_item);
    menubar.append(&file_item);

    vbox.pack_start(&menubar, false, false, 0);

    // ---- TOOLBAR ----
    let toolbar = Box::new(Orientation::Horizontal, 5);
    toolbar.set_border_width(5);

    let new_btn = Button::with_label("üìÑ Nuovo");
    let open_btn = Button::with_label("üìÇ Apri");
    let save_btn = Button::with_label("üíæ Salva");

    toolbar.pack_start(&new_btn, false, false, 0);
    toolbar.pack_start(&open_btn, false, false, 0);
    toolbar.pack_start(&save_btn, false, false, 0);

    vbox.pack_start(&toolbar, false, false, 0);

    // ---- TEXTVIEW ----
    let textview = TextView::new();
    textview.set_wrap_mode(gtk::WrapMode::Word);

    let scrolled = ScrolledWindow::new(None::<&gtk::Adjustment>, None::<&gtk::Adjustment>);
    scrolled.add(&textview);

    vbox.pack_start(&scrolled, true, true, 0);

    // ---- STATUS BAR ----
    let statusbar = Label::new(Some("Pronto"));
    statusbar.set_xalign(0.0);
    vbox.pack_start(&statusbar, false, false, 5);

    window.add(&vbox);
    window.show_all();

    // ---- EVENTS ----
    let current_file = Rc::new(RefCell::new(None::<String>));

    new_btn.connect_clicked(glib::clone!(@weak textview => move |_| {
        textview.buffer().unwrap().set_text("");
    }));

    quit_item.connect_activate(glib::clone!(@weak window => move |_| {
        window.close();
    }));
}

// ========================================
// FILE I/O HELPERS
// ========================================

fn load_file(path: &str) -> Result<String, std::io::Error> {
    std::fs::read_to_string(path)
}

fn save_file(path: &str, content: &str) -> Result<(), std::io::Error> {
    std::fs::write(path, content)
}
</code></pre>
            </div>

            <div class="box box-exercises">
                <h3>‚úèÔ∏è Esercizi Pratici</h3>
                <ol>
    <li><strong>Implementa Funzionalit√† Base</strong>
        <p>Completa Nuovo (svuota), Apri (FileChooser), Salva con FileChooserDialog funzionante.</p>
    </li>

    <li><strong>Barra di Ricerca</strong>
        <p>Aggiungi Entry per cercare testo nel TextView e bottone "Trova" che evidenzia risultati.</p>
    </li>

    <li><strong>Conta Parole e Caratteri</strong>
        <p>Label che mostra numero caratteri/parole/righe in tempo reale durante editing con connect_changed.</p>
    </li>

    <li><strong>Traccia Modifiche Non Salvate</strong>
        <p>Mostra asterisco nel titolo e conferma "Salvare?" con MessageDialog prima di chiudere.</p>
    </li>

    <li><strong>Recent Files Menu</strong>
        <p>Memorizza ultimi 5 file aperti in submenu "Recenti" con accesso veloce.</p>
    </li>

    <li><strong>Challenge: Syntax Highlighting Base</strong>
        <p>Aggiungi evidenziazione semplice per Rust: parole chiave in blu, stringhe in verde usando TextTag.</p>
    </li>
</ol>
            </div>

            <div class="box box-troubleshooting">
                <h3>‚ö†Ô∏è Troubleshooting</h3>
                <h4>‚ùå File non si salva</h4>
<p><strong>Soluzione:</strong> Verifica permessi directory e che il path sia corretto. Usa error handling con Result e match.</p>

<h4>‚ùå TextView non riempie spazio</h4>
<p><strong>Soluzione:</strong> Metti in ScrolledWindow e usa pack_start con expand=true e fill=true.</p>

<h4>‚ùå Button click non risponde</h4>
<p><strong>Soluzione:</strong> Verifica connect_clicked sia dichiarato DOPO window.show_all().</p>

<h4>üí° Tip: Auto-save</h4>
<p>Usa glib::timeout_add_seconds_local() per salvare ogni 5 minuti automaticamente.</p>

<h4>üí° Tip: Backup</h4>
<p>Prima di sovrascrivere, copia file in .backup per recuperare versioni precedenti.</p>
            </div>

            <nav class="lesson-nav">
                <a href="lesson-3-5.html">‚Üê Precedente</a>
                <a href="lesson-4-2.html">Successiva ‚Üí</a>
            </nav>
        </main>
    </div>

    <footer>
        <p>&copy; 2025 Corso Rust Linux Desktop | Creato con ‚ù§Ô∏è per la community Rust</p>
        <p><a href="https://www.rust-lang.org" target="_blank">Rust Programming Language</a> | <a href="https://gtk-rs.org" target="_blank">GTK-rs</a></p>
    </footer>

    <script src="script.js"></script>
</body>
</html>