<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Testing e Debugging | Corso Rust Linux Desktop</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="header-content">
            <div class="rust-logo">ü¶Ä</div>
            <h1>Corso Completo: Sviluppo Applicazioni Desktop Linux in Rust</h1>
        </div>
        <button class="menu-toggle" aria-label="Menu">‚ò∞</button>
    </header>

    <div class="container">
        <aside class="sidebar">
            <h3>üìö Corso</h3>
            <ul><li><a href="index.html">üè† Home</a></li></ul>
            <h3>1. Ambiente</h3>
            <ul><li><a href="lesson-1-1.html">1.1 Installazione Rust</a></li>
            <li><a href="lesson-1-2.html">1.2 Config VS Code</a></li>
            <li><a href="lesson-1-3.html">1.3 Strumenti Extra</a></li></ul>
            <h3>2. Rust Base</h3>
            <ul><li><a href="lesson-2-1.html">2.1 Sintassi</a></li>
            <li><a href="lesson-2-2.html">2.2 Controllo</a></li>
            <li><a href="lesson-2-3.html">2.3 Progetto</a></li>
            <li><a href="lesson-2-4.html">2.4 Crate</a></li></ul>
            <h3>3. GUI</h3>
            <ul><li><a href="lesson-3-1.html">3.1 GTK-rs</a></li>
            <li><a href="lesson-3-2.html">3.2 Glade</a></li>
            <li><a href="lesson-3-3.html">3.3 Manuale</a></li>
            <li><a href="lesson-3-4.html">3.4 Widget</a></li>
            <li><a href="lesson-3-5.html">3.5 Menu</a></li></ul>
            <h3>4. Progetti</h3>
            <ul><li><a href="lesson-4-1.html">4.1 Editor</a></li>
            <li><a href="lesson-4-2.html">4.2 Note DB</a></li>
            <li><a href="lesson-4-3.html">4.3 HTTP</a></li></ul>
            <h3>5. GitHub</h3>
            <ul><li><a href="lesson-5-1.html">5.1 Repository</a></li>
            <li><a href="lesson-5-2.html">5.2 Documentazione</a></li>
            <li><a href="lesson-5-3.html">5.3 Testing</a></li></ul>
            <h3>üìñ Risorse</h3>
            <ul><li><a href="about.html">‚ÑπÔ∏è Info Corso</a></li>
            <li><a href="resources.html">üîó Risorse</a></li>
            <li><a href="faq.html">‚ùì FAQ</a></li></ul>
        </aside>

        <main class="content">
            <nav class="breadcrumb"><a href="index.html">Home</a> > Sezione 5: GitHub & Best Practices > Testing e Debugging</nav>
            <h2 class="lesson-title">Testing e Debugging</h2>

            <div class="box box-theory">
                <h3>üìò Introduzione Teorica</h3>
                <p><strong>Testing e debugging</strong> sono fondamentali per affidabilit√†:</p>
<ul>
    <li><strong>Unit tests</strong>: Test singole funzioni con #[test]</li>
    <li><strong>Integration tests</strong>: Test workflow completi in tests/ dir</li>
    <li><strong>Doc tests</strong>: Esempi in rustdoc eseguiti come test</li>
    <li><strong>Benchmarks</strong>: Misura performance con criterion</li>
    <li><strong>Code coverage</strong>: % linee testate con tarpaulin</li>
    <li><strong>Property testing</strong>: Test con input randomico proptest</li>
    <li><strong>Debugging</strong>: gdb, lldb, println!, dbg!, eprintln!</li>
</ul>
<p>Codice ben testato √® codice affidabile e professionale.</p>
            </div>

            <div class="box box-steps">
                <h3>üîß Procedura Passo-Passo</h3>
                <ol>
    <li><strong>Unit test base</strong>
        <pre><code>#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_somma() {
        assert_eq!(somma(2, 3), 5);
    }
}</code></pre>
    </li>

    <li><strong>Esegui test</strong>
        <pre><code>cargo test
cargo test --release
cargo test -- --nocapture
cargo test test_name -- --exact</code></pre>
    </li>

    <li><strong>Integration test</strong>
        <pre><code>// File: tests/integration.rs
#[test]
fn test_complete_workflow() {
    // Test applicazione intera
}</code></pre>
    </li>

    <li><strong>Debug con macro</strong>
        <pre><code>dbg!(variabile);           // Print + ritorna valore
eprintln!("Debug: {:?}", v); // Print su stderr
println!("Info: {}", x);     // Print su stdout</code></pre>
    </li>

    <li><strong>Code coverage</strong>
        <pre><code>cargo install cargo-tarpaulin
cargo tarpaulin --out Html</code></pre>
    </li>
</ol>
            </div>

            <div class="box box-code">
                <h3>üíª Codice Sorgente Commentato</h3>
                <pre><code>// ========================================
// TESTING COMPLETO
// ========================================

pub fn somma(a: i32, b: i32) -> i32 {
    a + b
}

pub fn divide(a: i32, b: i32) -> Result<i32, String> {
    if b == 0 {
        Err("Division by zero".to_string())
    } else {
        Ok(a / b)
    }
}

// ========================================
// UNIT TESTS
// ========================================

#[cfg(test)]
mod tests {
    use super::*;

    // Basic assert
    #[test]
    fn test_somma_positive() {
        assert_eq!(somma(2, 3), 5);
    }

    #[test]
    fn test_somma_zero() {
        assert_eq!(somma(0, 0), 0);
        assert_eq!(somma(5, 0), 5);
    }

    // Negative numbers
    #[test]
    fn test_somma_negative() {
        assert_eq!(somma(-2, -3), -5);
        assert_eq!(somma(5, -3), 2);
    }

    // Result type
    #[test]
    fn test_divide_success() {
        assert!(divide(10, 2).is_ok());
        assert_eq!(divide(10, 2).unwrap(), 5);
    }

    #[test]
    fn test_divide_zero() {
        assert!(divide(10, 0).is_err());
    }

    // Panic test
    #[test]
    #[should_panic]
    fn test_panic() {
        panic!("This should panic");
    }

    // Custom error message
    #[test]
    fn test_with_message() {
        let result = somma(2, 3);
        assert_eq!(result, 5, "Expected 5, got {}", result);
    }

    // Ignore test
    #[test]
    #[ignore]
    fn expensive_test() {
        // Run only with: cargo test -- --ignored
    }
}

// ========================================
// PROPERTY TESTING
// ========================================

#[cfg(test)]
mod property_tests {
    use super::*;

    #[test]
    fn prop_somma_commutativa() {
        for a in -100..100 {
            for b in -100..100 {
                assert_eq!(somma(a, b), somma(b, a));
            }
        }
    }

    #[test]
    fn prop_somma_identity() {
        for a in -100..100 {
            assert_eq!(somma(a, 0), a);
        }
    }

    #[test]
    fn prop_somma_associativa() {
        for a in -20..20 {
            for b in -20..20 {
                for c in -20..20 {
                    assert_eq!(
                        somma(somma(a, b), c),
                        somma(a, somma(b, c))
                    );
                }
            }
        }
    }
}

// ========================================
// DEBUGGING TECHNIQUES
// ========================================

pub fn debug_example() {
    let x = 42;
    dbg!(x);  // Stampa: [src/main.rs:100] x = 42

    let v = vec![1, 2, 3];
    eprintln!("Vector DEBUG: {:?}", v);

    println!("Normal output: {}", 123);
}

// ========================================
// INTEGRATION TEST (tests/integration.rs)
// ========================================

/*
#[test]
fn test_complete_workflow() {
    let result = somma(2, 3);
    assert_eq!(result, 5);

    let div_result = divide(10, 2);
    assert_eq!(div_result, Ok(5));
}
*/
</code></pre>
            </div>

            <div class="box box-exercises">
                <h3>‚úèÔ∏è Esercizi Pratici</h3>
                <ol>
    <li><strong>Unit Test Base</strong>
        <p>Scrivi test per: somma, sottrazione, moltiplicazione di due numeri.</p>
    </li>

    <li><strong>Test Error Handling</strong>
        <p>Test per divide by zero, overflow, invalid input con Result type.</p>
    </li>

    <li><strong>Integration Test</strong>
        <p>Crea tests/integration.rs con test di workflow completo multi-funzioni.</p>
    </li>

    <li><strong>Property Testing</strong>
        <p>Verifica propriet√†: commutativa, associativa, identity per operazioni.</p>
    </li>

    <li><strong>Code Coverage</strong>
        <p>Installa tarpaulin e misura coverage: <code>cargo tarpaulin --out Html</code></p>
    </li>

    <li><strong>Challenge: Fuzzing</strong>
        <p>Usa proptest per generare input random, trova edge cases, aumenta robustezza.</p>
    </li>
</ol>
            </div>

            <div class="box box-troubleshooting">
                <h3>‚ö†Ô∏è Troubleshooting</h3>
                <h4>‚ùå Test panics ma non vuoi</h4>
<p><strong>Causa:</strong> Aspettavi Result ma usi unwrap().</p>
<p><strong>Soluzione:</strong> Usa Result&lt;T, E&gt; e match o ?.operator.</p>

<h4>‚ùå println! non appare in test</h4>
<p><strong>Causa:</strong> Output catturato da test runner.</p>
<p><strong>Soluzione:</strong> <code>cargo test -- --nocapture</code></p>

<h4>‚ùå Test molto lento</h4>
<p><strong>Causa:</strong> Combinazione unit + integration + benchmark.</p>
<p><strong>Soluzione:</strong> Separa: unit veloci (test/), integration (tests/), bench (benches/).</p>

<h4>‚ùå Test non esegue</h4>
<p><strong>Causa:</strong> Attributo #[test] mancante.</p>
<p><strong>Soluzione:</strong> Aggiungi #[test] prima di fn o #[ignore].</p>

<h4>üí° Tip: Test Organization</h4>
<p>Unit tests: vicino al codice. Integration: in tests/. Bench: in benches/.</p>

<h4>üí° Tip: Test Helpers</h4>
<p>Crea funzioni helper per test setup comune.</p>
            </div>

            <nav class="lesson-nav">
                <a href="lesson-5-2.html">‚Üê Precedente</a>
                <a class="disabled">Successiva ‚Üí</a>
            </nav>
        </main>
    </div>

    <footer>
        <p>&copy; 2025 Corso Rust Linux Desktop | Creato con ‚ù§Ô∏è per la community Rust</p>
        <p><a href="https://www.rust-lang.org" target="_blank">Rust Programming Language</a> | <a href="https://gtk-rs.org" target="_blank">GTK-rs</a></p>
    </footer>

    <script src="script.js"></script>
</body>
</html>